<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="前言本文将介绍笛卡尔空间规划方法。 说明：失踪人口回归，这段时间一直在帮导师写机器人运动规划方面的东西，之前从来没有接触过这方面的知识，通过不断地查资料看论文对机器人运动规划有了一些浅薄的认知。想通过这篇博客记录下学习到的笛卡尔空间规划的知识。">
<meta property="og:type" content="article">
<meta property="og:title" content="机械臂笛卡尔空间规划">
<meta property="og:url" content="http://example.com/2023/09/01/%E6%9C%BA%E6%A2%B0%E8%87%82%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A9%BA%E9%97%B4%E8%A7%84%E5%88%92/index.html">
<meta property="og:site_name" content="FaiMhr&#39;s Blog">
<meta property="og:description" content="前言本文将介绍笛卡尔空间规划方法。 说明：失踪人口回归，这段时间一直在帮导师写机器人运动规划方面的东西，之前从来没有接触过这方面的知识，通过不断地查资料看论文对机器人运动规划有了一些浅薄的认知。想通过这篇博客记录下学习到的笛卡尔空间规划的知识。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2023/09/01/%E6%9C%BA%E6%A2%B0%E8%87%82%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A9%BA%E9%97%B4%E8%A7%84%E5%88%92/%E7%A9%BA%E9%97%B4%E7%9B%B4%E7%BA%BF.jpg#centered">
<meta property="og:image" content="http://example.com/2023/09/01/%E6%9C%BA%E6%A2%B0%E8%87%82%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A9%BA%E9%97%B4%E8%A7%84%E5%88%92/%E7%A9%BA%E9%97%B4%E4%B8%89%E7%82%B9%E5%8F%8A%E7%9B%B8%E5%85%B3%E5%8F%82%E6%95%B0.jpg#centered">
<meta property="og:image" content="http://example.com/2023/09/01/%E6%9C%BA%E6%A2%B0%E8%87%82%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A9%BA%E9%97%B4%E8%A7%84%E5%88%92/%E5%B9%B3%E9%9D%A2%E5%9D%90%E6%A0%87%E7%B3%BB%E5%AE%9A%E4%B9%89.jpg#centered">
<meta property="article:published_time" content="2023-09-01T09:00:00.000Z">
<meta property="article:modified_time" content="2023-09-04T15:27:16.753Z">
<meta property="article:author" content="马泓睿">
<meta property="article:tag" content="运动规划">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2023/09/01/%E6%9C%BA%E6%A2%B0%E8%87%82%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A9%BA%E9%97%B4%E8%A7%84%E5%88%92/%E7%A9%BA%E9%97%B4%E7%9B%B4%E7%BA%BF.jpg#centered">

<link rel="canonical" href="http://example.com/2023/09/01/%E6%9C%BA%E6%A2%B0%E8%87%82%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A9%BA%E9%97%B4%E8%A7%84%E5%88%92/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>机械臂笛卡尔空间规划 | FaiMhr's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="FaiMhr's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">FaiMhr's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Code is magic.</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/09/01/%E6%9C%BA%E6%A2%B0%E8%87%82%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A9%BA%E9%97%B4%E8%A7%84%E5%88%92/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="马泓睿">
      <meta itemprop="description" content="If I have been able to see further, it was only because I stood on the shoulder of giants.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FaiMhr's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          机械臂笛卡尔空间规划
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-09-01 17:00:00" itemprop="dateCreated datePublished" datetime="2023-09-01T17:00:00+08:00">2023-09-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-09-04 23:27:16" itemprop="dateModified" datetime="2023-09-04T23:27:16+08:00">2023-09-04</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BF%90%E5%8A%A8%E8%A7%84%E5%88%92/" itemprop="url" rel="index"><span itemprop="name">运动规划</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>本文将介绍笛卡尔空间规划方法。</p>
<p>说明：失踪人口回归，这段时间一直在帮导师写机器人运动规划方面的东西，之前从来没有接触过这方面的知识，通过不断地查资料看论文对机器人运动规划有了一些浅薄的认知。想通过这篇博客记录下学习到的笛卡尔空间规划的知识。</p>
<span id="more"></span>
<h1 id="笛卡尔空间规划介绍"><a href="#笛卡尔空间规划介绍" class="headerlink" title="笛卡尔空间规划介绍"></a>笛卡尔空间规划介绍</h1><p>在机械臂的实际应用中，通常要求机械臂末端执行器沿着指定的路径（如直线、平面曲线或空间曲线等）进行运动，或者在多点之间进行移动。笛卡尔空间规划就是就是来规划机械臂末端执行器在工作空间运动的轨迹，这个轨迹不光规划了末端执行器所在空间中的位置信息还规划了末端执行器在空间中的姿态。</p>
<p>笛卡尔空间进行规划主要分为以下几步：</p>
<p><strong>第一步</strong>，确定末端执行器需要经过的关键点，关键点的确定最简单的可以通过对机械臂进行示教的方式实现；还可以通过一些避障算法实现，因为选关键点除去起始点和目标点，无非就是为了选取一些关键点让执行器避开障碍物。</p>
<p><strong>第二步</strong>，确定末端执行器在指定的若干关键点处的位姿（比如在进行从上方抓取物体并放置的任务时，当关键点只有起始点和目标点时，起始点和目标点机械臂末端执行器的Z轴需要垂直于物体），位姿确定后我们就得到了关键点在空间中的x，y，z轴坐标和末端执行器在此关键点的偏航角，俯仰角和翻滚角。</p>
<p><strong>第三步</strong>，当关键点处位姿确定后就需要确定关键点之间是如何连接的，也就是要对这些离散的点进行插值或者平滑处理来得到连续的笛卡尔空间轨迹。最简单也是最常用的是通过直线、圆弧或者直线加圆弧混合的方式依次对关键点进行连接，更高级的可以使用高阶多项式、样条曲线和参数化曲线（贝塞尔曲线和B样条曲线）等（这些曲线多用于关节空间规划中）。</p>
<p><strong>第四步</strong>，由于机械臂由多个关节组成即使得到了机械臂末端执行器的路径并不能直接进行控制，还需要把路径分成多个点，并把每个点进行运动学逆解得到对应的关节角度，这样就可以通过控制关节来实现对末端执行器的控制。所以到底要取多少个点需要自己定，点越多肯定和曲线越接近，但进行运动学逆解的运算量就越大（不是一般的大O.O）。</p>
<p>下面将介绍直线插值和圆弧插值，更高级的方法在笛卡尔空间的应用在这先挖个坑后面会补上哦。</p>
<h2 id="直线插值"><a href="#直线插值" class="headerlink" title="直线插值"></a>直线插值</h2><p>在机械臂笛卡尔空间规划中，直线插值是较为重要的插值方法。如图1所示，末端执行器将从点\(P\)直线运动到点\(Q\)，假设移动速度为\(v\)，位姿插补的时间间隔为\(T\)，点\(P\)的坐标为\(P\left[ { {x_0},{y_0},{z_0} } \right]\)，点\(Q\)的坐标为\(Q\left[ { {x_n},{y_n},{z_n} } \right]\)。</p>
<p><img src="空间直线.jpg#centered" alt="空间直线"></p>
<p style="text-align:center;">图1 空间直线</p>

<p>点\(P\)到点\(Q\)的距离\(L\)如式（1）所示。</p>
<html>

<head>
  <title>距离\\(L\\)公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;text-align: center;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">$$L = \sqrt { { {({x_n} - {x_0})}^2} + { {({y_n} - {y_0})}^2} + { {({z_n} - {z_0})}^2} } $$</td>
    <td style="border: none;width: 20px;text-align: right;">式(1)</td>
  </tr>
</table>
</body>

</html>


<p>末端执行器单次时间间隔\(T\)内的行程\(d\)如式（2）所示。</p>
<html>

<head>
  <title>行程\\(d\\)公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;text-align: center;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;text-align: right;">$$d = vT$$</td>
    <td style="border: none;width: 20px;text-align: right;">式(2)</td>
  </tr>
</table>
</body>

</html>


<p>插值总次数\(N\)如式（3）所示。</p>
<html>

<head>
  <title>插值总次数\\(N\\)公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">$$N = ceil\left( {\frac{L}{d} } \right)$$</td>
    <td style="border: none;width: 20px;text-align: right;">式(3)</td>
  </tr>
</table>
</body>

</html>


<p>其中，\(ceil()\)为向上取整函数。</p>
<p>注：这里我认为插值次数也可以自己定不一定要按公式来。</p>
<p>各坐标轴增量如式（4）所示。</p>
<html>

<head>
  <title>各坐标轴增量公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">$$\left\{ \begin{array}{l}
\Delta x = \frac{ { {x_n} - {x_0} } }{N}\\
\Delta y = \frac{ { {y_n} - {y_0} } }{N}\\
\Delta z = \frac{ { {z_n} - {z_0} } }{N}
\end{array} \right.$$</td>
    <td style="border: none;width: 20px;text-align: right;">式(4)</td>
  </tr>
</table>
</body>

</html>


<p>\(T_i()\)时刻机械臂末端执行器在空间坐标系中的坐标值如式（5）所示。</p>
<html>

<head>
  <title>\\(T_i()\\)时刻机械臂末端执行器在空间坐标系中的坐标值公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">$$\left\{ \begin{array}{l}
x = {x_{i - 1} } + i\Delta x\\
y = {y_{i - 1} } + i\Delta y\\
z = {z_{i - 1} } + i\Delta z
\end{array} \right.$$</td>
    <td style="border: none;width: 20px;text-align: right;">式(5)</td>
  </tr>
</table>
</body>

</html>


<h2 id="圆弧插值"><a href="#圆弧插值" class="headerlink" title="圆弧插值"></a>圆弧插值</h2><p>在空间中，通过不在同一直线上的三个点可确定一个圆及三点间的圆弧。假设机械臂笛卡尔空间中的三个节点分别是圆弧的起点\(P\left[ { {x_p},{y_p},{z_p} } \right]\)，圆弧的中间点\(Q\left[ { {x_q},{y_q},{z_q} } \right]\)，圆弧的终点\(R\left[ { {x_r},{y_r},{z_r} } \right]\)，圆弧的圆心\(C\left[ { {x_c},{y_c},{z_c} } \right]\)，圆弧的半径为\(r\)，如图2所示。</p>
<p><img src="空间三点及相关参数.jpg#centered" alt="空间三点及相关参数"></p>
<p style="text-align:center;">图2 空间三点及相关参数</p>

<p>向量\(PQ\)和向量\(QR\)分别如式（6）和式（7）所示。</p>
<html>

<head>
  <title>向量\\(PQ\\)公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">$$PQ = {[\begin{array}{*{20}{c} }
{ {x_q} - {x_p} }&{ {y_q} - {y_p} }&{ {z_q} - {z_p} }
\end{array}]^{\rm{T} } }$$</td>
    <td style="border: none;width: 20px;text-align: right;">式(6)</td>
  </tr>
</table>
</body>

</html>


<html>

<head>
  <title>向量\\(QR\\)公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">$$QR = {[\begin{array}{*{20}{c} }
{ {x_r} - {x_q} }&{ {y_r} - {y_q} }&{ {z_r} - {z_q} }
\end{array}]^{\rm{T} } }$$</td>
    <td style="border: none;width: 20px;text-align: right;">式(7)</td>
  </tr>
</table>
</body>

</html>


<p>则\(P\)、\(Q\)、\(R\)三点所在平面\(I\)的法向量\(n\)如式（8）所示。</p>
<html>

<head>
  <title>法向量\\(n\\)公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">\[n = {\left[ {\begin{array}{*{20}{c} }
{ {n_x} }&{ {n_y} }&{ {n_z} }
\end{array} } \right]^{\rm{T} } } = PQ \times QR = \left| {\begin{array}{*{20}{c} }
i&j&k\\
{ {x_q} - {x_p} }&{ {y_q} - {y_p} }&{ {z_q} - {z_p} }\\
{ {x_r} - {x_q} }&{ {y_r} - {y_q} }&{ {z_r} - {z_q} }
\end{array} } \right|\]</td>
    <td style="border: none;width: 20px;text-align: right;">式(8)</td>
  </tr>
</table>
</body>

</html>


<p>由圆的性质可知，线段\(PQ\)的中垂线和线段\(QR\)的中垂线的交点即为圆弧的圆心。</p>
<p>同时垂直于向量\(n\)和向量\(PQ\)的向量即为线段\(PQ\)的中垂线的方向向量\(n_1\)，\(n_1\)如式（9）所示。</p>
<html>

<head>
  <title>方向向量\\(n_1\\)公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">\[{n_1} = {\left[ {\begin{array}{*{20}{c} }
{ {n_{1x} } }&{ {n_{1y} } }&{ {n_{1z} } }
\end{array} } \right]^{\rm{T} } } = n \times PQ = \left| {\begin{array}{*{20}{c} }
i&j&k\\
{ {n_x} }&{ {n_y} }&{ {n_z} }\\
{ {x_q} - {x_p} }&{ {y_q} - {y_p} }&{ {z_q} - {z_p} }
\end{array} } \right|\]</td>
    <td style="border: none;width: 20px;text-align: right;">式(9)</td>
  </tr>
</table>
</body>

</html>


<p>假设线段\(PQ\)的中点为\(A\left[ { {a_x},{a_y},{a_z} } \right]\)，由\(P\)点和\(Q\)点的坐标可得\(a_x\)、\(a_y\)、\(a_z\)的值如式（10）所示。</p>
<html>

<head>
  <title>点\\(A\\)坐标公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">\[{a_x} = \frac{ { {x_q} + {x_p} } }{2},{a_y} = \frac{ { {y_q} + {y_p} } }{2},{a_y} = \frac{ { {z_q} + {z_p} } }{2}\]</td>
    <td style="border: none;width: 20px;text-align: right;">式(10)</td>
  </tr>
</table>
</body>

</html>


<p>线段\(PQ\)的中垂线所在直线的方程\(L_1\)如式（11）所示。</p>
<html>

<head>
  <title>直线\\(L_1\\)方程</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">\[\frac{ {x - {a_x} } }{ { {n_{1x} } } } = \frac{ {y - {a_y} } }{ { {n_{1y} } } } = \frac{ {z - {a_z} } }{ { {n_{1z} } } }\]</td>
    <td style="border: none;width: 20px;text-align: right;">式(11)</td>
  </tr>
</table>
</body>

</html>


<p>同时垂直于向量\(n\)和向量\(QR\)的向量即为线段\(QR\)的中垂线的方向向量\(n_2\)，\(n_2\)如式（12）所示。</p>
<html>

<head>
  <title>方向向量\\(n_2\\)公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">\[{n_2} = {\left[ {\begin{array}{*{20}{c} }
{ {n_{2x} } }&{ {n_{2y} } }&{ {n_{2z} } }
\end{array} } \right]^{\rm{T} } } = n \times PQ = \left| {\begin{array}{*{20}{c} }
i&j&k\\
{ {n_x} }&{ {n_y} }&{ {n_z} }\\
{ {x_r} - {x_q} }&{ {y_r} - {y_q} }&{ {z_r} - {z_q} }
\end{array} } \right|\]</td>
    <td style="border: none;width: 20px;text-align: right;">式(12)</td>
  </tr>
</table>
</body>

</html>


<p>假设线段\(QR\)的中点为\(B\left[ { {b_x},{b_y},{b_z} } \right]\)，由\(Q\)点和\(R\)点的坐标可得\(b_x\)、\(b_y\)、\(b_z\)的值如式（13）所示。</p>
<html>

<head>
  <title>点\\(B\\)坐标公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">\[{b_x} = \frac{ { {x_r} + {x_q} } }{2},{b_y} = \frac{ { {y_r} + {y_q} } }{2},{b_y} = \frac{ { {z_r} + {z_q} } }{2}\]</td>
    <td style="border: none;width: 20px;text-align: right;">式(13)</td>
  </tr>
</table>
</body>

</html>


<p>线段\(QR\)的中垂线所在直线的方程\(L_2\)如式（14）所示。</p>
<html>

<head>
  <title>直线\\(L_2\\)方程</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">\[\frac{ {x - {b_x} } }{ { {n_{2x} } } } = \frac{ {y - {b_y} } }{ { {n_{2y} } } } = \frac{ {z - {b_z} } }{ { {n_{2z} } } }\]</td>
    <td style="border: none;width: 20px;text-align: right;">式(14)</td>
  </tr>
</table>
</body>

</html>


<p>由圆的性质可知，直线\(L_1\)和\(L_2\)的交点即为圆弧轨迹的圆心。可以采用线性方程组解法，将直线方程\(L_1\)和\(L_2\)转化成空间直线的一般式，由于方程组个数大于未知量个数，故利用广义逆来求\(L_1\)和\(L_2\)的交点，即圆弧的圆心坐标如式（15）所示。</p>
<html>

<head>
  <title>圆弧圆心\\(C\\)坐标</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">\[\left[ {\begin{array}{*{20}{c} }
{ {x_c} }\\
{ {y_c} }\\
{ {z_c} }
\end{array} } \right] = {\left[ {\begin{array}{*{20}{c} }
{ {\rm{ } }{n_{1y} }{\rm{\ \ \ } }{n_{1x} }{\rm{\ \ \ } }0{\rm{\ \ } } }\\
{ {\rm{\ } }0{\rm{\ \ \ } }{n_{1z} }{\rm{\ \ \ } }{n_{1y} } }\\
{ {n_{2y} }{\rm{\ \ \ } }{n_{2x} }{\rm{\ \ \ } }0{\rm{\ \ } } }\\
{ {\rm{\ } }0{\rm{\ \ \ \ } }{n_{2z} }{\rm{\ \ \ } }{n_{2y} } }
\end{array} } \right]^ + } \cdot \left[ {\begin{array}{*{20}{c} }
{ {a_x}{n_{1y} } - {n_{1x} }{a_y} }\\
{ {a_y}{n_{1z} } - {a_z}{n_{1y} } }\\
{ {b_x}{n_{2y} } - {n_{2x} }{b_y} }\\
{ {b_y}{n_{2z} } - {b_z}{n_{2y} } }
\end{array} } \right]\]</td>
    <td style="border: none;width: 20px;text-align: right;">式(15)</td>
  </tr>
</table>
</body>

</html>


<p>求得了圆弧的圆心坐标\(\left[ { {x_c},{y_c},{z_c} } \right]\)，则\(CP\)、\(CQ\)、\(CR\)三个向量的模都等于圆弧的半径\(r\)，如式（16）所示。</p>
<html>

<head>
  <title>圆弧半径\\(r\\)公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">\[r = \left| {CP} \right| = \left| {CQ} \right| = \left| {CR} \right|\]</td>
    <td style="border: none;width: 20px;text-align: right;">式(16)</td>
  </tr>
</table>
</body>

</html>


<p>将空间圆弧转换为平面圆弧。如图3所示，建立坐标系{\(O’\)\(X’\)\(Y’\)\(Z’\)}，使原点\(O’\)位于圆心\(C\)处，以向量\(CP\)所在直线为\(X’\)轴，方向与向量\(CP\)相同，过点\(C\)且垂直于平面\(I\)的直线为\(Z’\)轴，\(Y’\)轴由右手定则确定，且平面\(X’\)\(O’\)\(Y’\)与平面\(I\)重合。</p>
<p><img src="平面坐标系定义.jpg#centered" alt="平面坐标系定义"></p>
<p style="text-align:center;">图3 平面坐标系定义</p>

<p>假设\(X’\)轴上的单位向量为\(i’\)，它在坐标系{\(O\)\(X\)\(Y\)\(Z\)}中如式（17）所示。</p>
<html>

<head>
  <title>单位向量\\(i’\\)公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">\[i' = {\left[ {\begin{array}{*{20}{c} }
{\frac{ { {x_p} - {x_c} } }{ {\left| {CP} \right|} } }&{\frac{ { {y_p} - {y_c} } }{ {\left| {CP} \right|} } }&{\frac{ { {z_p} - {z_c} } }{ {\left| {CP} \right|} } }
\end{array} } \right]^{\rm{T} } }\]</td>
    <td style="border: none;width: 20px;text-align: right;">式(17)</td>
  </tr>
</table>
</body>

</html>


<p>假设\(Z’\)轴上的单位向量为\(k’\)，它在坐标系{\(O\)\(X\)\(Y\)\(Z\)}中如式（18）所示。</p>
<html>

<head>
  <title>单位向量\\(k’\\)公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">\[k' = \frac{n}{ {\left| n \right|} } = {\left[ {\begin{array}{*{20}{c} }
{\frac{ { {n_x} } }{ {\left| n \right|} } }&{\frac{ { {n_y} } }{ {\left| n \right|} } }&{\frac{ { {n_z} } }{ {\left| n \right|} } }
\end{array} } \right]^{\rm{T} } }\]</td>
    <td style="border: none;width: 20px;text-align: right;">式(18)</td>
  </tr>
</table>
</body>

</html>


<p>假设\(Y’\)轴上的单位向量为\(j’\)，它在坐标系{\(O\)\(X\)\(Y\)\(Z\)}中如式（19）所示。</p>
<html>

<head>
  <title>单位向量\\(j’\\)公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">\[\begin{array}{l}
j' = k' \times i'\\
{\rm{\ \ } } = {\left[ {\begin{array}{*{20}{c} }
{\frac{ { {y_p} - {y_c} } }{ {\left| {CP} \right|} } \cdot \frac{ { {n_x} } }{ {\left| n \right|} } - \frac{ { {z_p} - {z_c} } }{ {\left| {CP} \right|} } \cdot \frac{ { {n_y} } }{ {\left| n \right|} } }&{\frac{ { {z_p} - {z_c} } }{ {\left| {CP} \right|} } \cdot \frac{ { {n_x} } }{ {\left| n \right|} } - \frac{ { {x_p} - {x_c} } }{ {\left| {CP} \right|} } \cdot \frac{ { {n_z} } }{ {\left| n \right|} } }&{\frac{ { {x_p} - {x_c} } }{ {\left| {CP} \right|} } \cdot \frac{ { {n_y} } }{ {\left| n \right|} } - \frac{ { {y_p} - {y_c} } }{ {\left| {CP} \right|} } \cdot \frac{ { {n_x} } }{ {\left| n \right|} } }
\end{array} } \right]^{\rm{T} } }
\end{array}\]</td>
    <td style="border: none;width: 20px;text-align: right;">式(19)</td>
  </tr>
</table>
</body>

</html>


<p>则坐标系{\(O’\)\(X’\)\(Y’\)\(Z’\)}到坐标系{\(O\)\(X\)\(Y\)\(Z\)}之间的转换矩阵\({}_o^{o’}T\)如式（20）所示。</p>
<html>

<head>
  <title>转换矩阵\\({}_o^{o'}T\\)公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">\[{}_o^{o'}T = \left[ {\begin{array}{*{20}{c} }
{\frac{ { {x_p} - {x_c} } }{ {\left| {CP} \right|} } }&{\frac{ { {y_p} - {y_c} } }{ {\left| {CP} \right|} } \cdot \frac{ { {n_z} } }{ {\left| n \right|} } - \frac{ { {z_p} - {z_c} } }{ {\left| {CP} \right|} } \cdot \frac{ { {n_y} } }{ {\left| n \right|} } }&{\frac{ { {n_x} } }{ {\left| n \right|} } }&{ {x_c} }\\
{\frac{ { {y_p} - {y_c} } }{ {\left| {CP} \right|} } }&{\frac{ { {z_p} - {z_c} } }{ {\left| {CP} \right|} } \cdot \frac{ { {n_x} } }{ {\left| n \right|} } - \frac{ { {x_p} - {x_c} } }{ {\left| {CP} \right|} } \cdot \frac{ { {n_z} } }{ {\left| n \right|} } }&{\frac{ { {n_y} } }{ {\left| n \right|} } }&{ {y_c} }\\
{\frac{ { {z_p} - {z_c} } }{ {\left| {CP} \right|} } }&{\frac{ { {x_p} - {x_c} } }{ {\left| {CP} \right|} } \cdot \frac{ { {n_y} } }{ {\left| n \right|} } - \frac{ { {y_p} - {y_c} } }{ {\left| {CP} \right|} } \cdot \frac{ { {n_x} } }{ {\left| n \right|} } }&{\frac{ { {n_z} } }{ {\left| n \right|} } }&{ {z_c} }\\
0&0&0&1
\end{array} } \right]\]</td>
    <td style="border: none;width: 20px;text-align: right;">式(20)</td>
  </tr>
</table>
</body>

</html>


<p>则坐标系{\(O’\)\(X’\)\(Y’\)\(Z’\)}中任意点的坐标(\(x’\),\(y’\),\(z’\))，则它在坐标系{\(O\)\(X\)\(Y\)\(Z\)}中对应点(\(x\),\(y\),\(z\))如式（21）所示。</p>
<html>

<head>
  <title>两坐标系点的对应公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">\[\left[ {\begin{array}{*{20}{c} }
{x'}\\
{y'}\\
{z'}\\
1
\end{array} } \right] = {}_o^{o'}{T^{ - 1} }\left[ {\begin{array}{*{20}{c} }
x\\
y\\
z\\
1
\end{array} } \right]\]</td>
    <td style="border: none;width: 20px;text-align: right;">式(21)</td>
  </tr>
</table>
</body>

</html>


<p>利用上式就能得到\(P\)、\(Q\)、\(R\)、\(C\)四个点在坐标系{\(O’\)\(X’\)\(Y’\)\(Z’\)}中对应点的坐标。</p>
<p>得到坐标后就可以进行圆弧插补轨迹的规划，首先在平面坐标系{\(O’\)\(X’\)\(Y’\)\(Z’\)}中，计算圆弧\(PQR\)的圆心角\(θ\)和插值次数\(N\)。如图3所示，圆心角\(θ\)可能有两种情况：\(θ≤π\)和\(θ&gt;π\)。这里，利用向量\(O’P\)和\(PR\)的法向量\(n_3\)与平面\(X’O’Y’\)的法向量\(n\)的内积来判断\(θ\)的值,如式（22）所示。</p>
<html>

<head>
  <title>内积\\(H\\)公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">\[H = {n_3} \cdot n = O'P \times PR \cdot n\]</td>
    <td style="border: none;width: 20px;text-align: right;">式(22)</td>
  </tr>
</table>
</body>

</html>


<p>若\(H≥0\)，则\(θ≤π\)，\(\theta  = 2\arcsin \left( {\frac{ {\left| {PR} \right|} }{ {2r} } } \right)\);若\(H<0\\)，则\\(θ>π\)，\(\theta  = 2\pi  - 2\arcsin \left( {\frac{ {\left| {PR} \right|} }{ {2r} } } \right)\)。</0\\)，则\\(θ></p>
<p>假设机械臂的插补周期为\(t\)，移动速度为\(v\)，则机械臂末端执行器从当前点切向移动到下一个插补点的距离如式（23）所示。</p>
<html>

<head>
  <title>间距公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">\[\Delta s = vt\]</td>
    <td style="border: none;width: 20px;text-align: right;">式(23)</td>
  </tr>
</table>
</body>

</html>


<p>步距角\(δ\)可如式（24）所示。</p>
<html>

<head>
  <title>步距角\\(δ\\)公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">\[\delta  = \arcsin \left( {\frac{ {vt} }{r} } \right)\]</td>
    <td style="border: none;width: 20px;text-align: right;">式(24)</td>
  </tr>
</table>
</body>

</html>


<p>插值总次数\(N\)如式（25）所示。</p>
<html>

<head>
  <title>插值总次数\\(N\\)公式</title>
</head>

<body>
<table style="width:100%;border-collapse: collapse;">
  <tr style="border-top: none;">
    <td style="border: none;width: 20px;">&nbsp</td>
    <td style="border: none;width: 100px;">$$N = ceil\left( {\frac{\theta }{\delta } } \right)$$</td>
    <td style="border: none;width: 20px;text-align: right;">式(25)</td>
  </tr>
</table>
</body>

</html>


<p>其中，\(ceil()\)为向上取整函数。</p>
<p>然后，在坐标系{\(O’\)\(X’\)\(Y’\)\(Z’\)}中，从\(P\)点开始，依次计算出圆弧轨迹上每个插补点的位置坐标(\(x’\),\(y’\),\(z’\))，再利用坐标变换矩阵\({}_o^{o’}T\)求得该点在机械臂参考坐标系{\(O\)\(X\)\(Y\)\(Z\)}中的坐标(\(x\),\(y\),\(z\))，这样就完成了机械臂圆弧插补轨迹的规划。</p>
<p>既然有了直线和圆弧的插值方法，那将直线插值方法和圆弧插值方式进行组合使用也就很好实现啦。（这里先偷个懒，可能等后面有时间再补上吧）</p>
<p>当然了还有其他的一些高级方法哦。（这里也先偷个懒，主要还是这些方法有些细节我还没弄明白先弄明白再来写）</p>
<h2 id="姿态控制规划"><a href="#姿态控制规划" class="headerlink" title="姿态控制规划"></a>姿态控制规划</h2><p>注：简单介绍下，感觉不是很详细，后面补充</p>
<p>对于机械臂的姿态控制规划，特别是在执行中间路径时，有几种方法可以实现。以下是一些常见的方法：</p>
<p><strong>插值方法</strong>：这是最简单的方法之一，涉及将中间路径上的姿态点进行插值，以便在这些点之间平滑地进行运动。简单来说和前面一样就是把离散的点连接起来，确保机械臂在路径上均匀地变化姿态，从而实现平滑的运动。</p>
<p>举个例子，当我们有了起始姿态和目标姿态后，我们通过在起始姿态和目标姿态之间选择一些中间点，然后对这些点使用相应的插值方法进行插值。</p>
<p><strong>关节空间插补</strong>：机械臂通常由一系列关节连接而成。在关节空间中，可以对各个关节的角度进行插值，从而控制机械臂的姿态。这种方法适用于具有较大自由度的机械臂，可以避免姿态的奇异性问题。</p>
<p>举个例子，当我们有了起始姿态和目标姿态后，使用逆运动学，我们可以计算出每个中间点的关节角度，然后对这些关节角度使用相应的插值方法进行插值。</p>
<p><strong>欧拉角/四元数插值</strong>：如果机械臂的姿态由欧拉角（滚转、俯仰、偏航）或者四元数表示，可以对这些表示进行插值。这样可以确保在中间路径上平滑地过渡，同时避免姿态的奇异性问题。</p>
<p>举个例子，假设我们使用欧拉角来表示姿态（欧拉角和四元数可以进行转换）。当我们通过正运动学有了起始欧拉角和目标欧拉角后，可以在起始欧拉角和目标欧拉角之间分别对滚转、俯仰和偏航角使用相应的插值方法进行插值。</p>
<p><strong>算法</strong>：可以通过一些启发式或者采样的算法，从起始姿态开始，逐步生成到目标姿态的路径。</p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>到此为止我们通过前面的方法得到了大量离散的路径点，后面还需要根据机械臂逆解得到每个点所对应的机械臂每个关节的关节角度，也就是转化为机械臂的关节角度序列，到这里实际上我们已经完成了笛卡尔空间规划。<strong>但是要注意一点哦</strong>，即使取的点够密集那也是离散的点（比如相邻两点，第一个关节角度分别为30°和30.001°，即使它们相差很小，但他们的关节角度不是连续的），关节角度不可能直接发生瞬间变化所以那就还需要在关节空间对其关节角度进行规划给它一个变化的过渡过程，这就是关节空间规划的任务啦。</p>
<p>注：<br>其实一开始我一直以为笛卡尔空间规划就只是规划出一条在空间中的路径，其实并不是这样的，因为在这段路径中其实还包括机械臂姿态的问题，也就是机械臂在笛卡尔空间进行轨迹规划的过程需要对末端执行器位置和姿态都进行规划。</p>
<style>
    img[src*='centered'] {
        margin:auto;
        display:block;
    }
</style>

    </div>

    
    
    
    <div>
      
      <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>

      
    </div>

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E8%BF%90%E5%8A%A8%E8%A7%84%E5%88%92/" rel="tag"># 运动规划</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2023/04/20/%E7%BD%97%E6%8A%80flow%E8%BF%9E%E6%8E%A5%E9%97%AE%E9%A2%98/" rel="prev" title="罗技flow连接问题">
      <i class="fa fa-chevron-left"></i> 罗技flow连接问题
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A9%BA%E9%97%B4%E8%A7%84%E5%88%92%E4%BB%8B%E7%BB%8D"><span class="nav-number">2.</span> <span class="nav-text">笛卡尔空间规划介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9B%B4%E7%BA%BF%E6%8F%92%E5%80%BC"><span class="nav-number">2.1.</span> <span class="nav-text">直线插值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9C%86%E5%BC%A7%E6%8F%92%E5%80%BC"><span class="nav-number">2.2.</span> <span class="nav-text">圆弧插值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A7%BF%E6%80%81%E6%8E%A7%E5%88%B6%E8%A7%84%E5%88%92"><span class="nav-number">2.3.</span> <span class="nav-text">姿态控制规划</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93"><span class="nav-number">2.4.</span> <span class="nav-text">小结</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->



      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="马泓睿"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">马泓睿</p>
  <div class="site-description" itemprop="description">If I have been able to see further, it was only because I stood on the shoulder of giants.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">10</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>
     
      <div>
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="420" height="86" src="//music.163.com/outchain/player?type=2&id=28151022&auto=1&height=66"></iframe> 
      </div>


    </div>
  </aside>
  <div id="sidebar-dimmer"></div> 


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fas fa-user" /></i>
  </span>
  <span class="author" itemprop="copyrightHolder">马泓睿</span>
</div>

<!--添加运行时间-->
<div>
  <span id="sitetime"></span>
  <script language=javascript>
      function siteTime(){
          window.setTimeout("siteTime()", 1000);
          var seconds = 1000;
          var minutes = seconds * 60;
          var hours = minutes * 60;
          var days = hours * 24;
          var years = days * 365;
          var today = new Date();
          var todayYear = today.getFullYear();
          var todayMonth = today.getMonth()+1;
          var todayDate = today.getDate();
          var todayHour = today.getHours();
          var todayMinute = today.getMinutes();
          var todaySecond = today.getSeconds();
          /*
        Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
        year - 作为date对象的年份，为4位年份值
        month - 0-11之间的整数，做为date对象的月份
        day - 1-31之间的整数，做为date对象的天数
        hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
        minutes - 0-59之间的整数，做为date对象的分钟数
        seconds - 0-59之间的整数，做为date对象的秒数
        microseconds - 0-999之间的整数，做为date对象的毫秒数
       */
          var t1 = Date.UTC(2020,03,14,18,12,20); //北京时间2018-2-13 00:00:00
          var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
          var diff = t2-t1;
          var diffYears = Math.floor(diff/years);
          var diffDays = Math.floor((diff/days)-diffYears*365);
          var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
          var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
          var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
          document.getElementById("sitetime").innerHTML=" 已运行"+/*diffYears+" 年 "+*/diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
      }
      siteTime();
  </script>
</div>
<!--// 添加运行时间-->

<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="theme-info">
  <div class="powered-by"></div>
  
  <span class="post-count">博客全站共16.6k字</span>
  <span class="post-meta-divider">|</span>
  本站访客数<span id="busuanzi_value_site_uv"></span>人次
</div>


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,0' opacity='0.5' zIndex='-1' count='150' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

<script src="/live2dwlib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw","pluginJsPath":"lib/","pluginModePath":"assets/","tegMode":false,"debug":false,"model":{"jsonPath":"live2d-widget-model-miku"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"react":{"opacity":0.7},"log":false,"pluginModelPath":"assets/","tagMode":false});</script></body>
</html>

<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/clicklove.js"></script>

